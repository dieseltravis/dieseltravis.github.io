<!doctype html><html lang="en-us" class="no-js"><head><meta name="viewport" content="width=device-width"/><title>Compiling an XSLT into a DLL binary</title><meta name="description" content="[object Object]"/><meta name="author" content="Travis Hardiman"/><meta name="copyright" content="© Travis Hardiman, et al. 1979-2079."/><link rel="stylesheet" href="/s/mainWjx.css"/><link rel="canonical" href="http://dieseltravis.github.io/posts/2010/07/19/compiling-an-xslt-into-a-dll-binary"/><link rel="alternate" type="application/rss+xml" title="RSS" href="http://dieseltravis.github.io/rss.rss"/><link rel="alternate" type="application/atom+xml" title="Atom" href="http://dieseltravis.github.io/atom.atom"/></head><body><header><hgroup><h1><a href="/" rel="home">traviblog</a></h1><h2>the enterprising blog with the home-made touch</h2></hgroup></header><main><article class="h-entry"><hgroup><h3><time datetime="2010-07-19T22:51:30.414Z" pubdate="pubdate" class="dt-published">2010-07-19</time></h3><h1><a href="/posts/2010/07/19/compiling-an-xslt-into-a-dll-binary" class="u-url p-name">Compiling an XSLT into a DLL binary</a></h1><h2 class="p-summary"></h2></hgroup><div class="e-content"><img src="http://farm5.static.flickr.com/4134/4819182574_af35276dbd_o.png" alt="Project Properties - Pre-Build Event" width="619" height="383" style="float:right"/><p>Did you know that Microsoft <a href="#20100719-1">provides</a> <a href="#20100719-2">tools</a> to compile XSLT files into DLLs? Neither did I before a client recently suggested that I do that on a recent project. It turns out it's extremely easy.</p><p>Fire up your <a href="http://sourceforge.net/projects/console/">favorite console</a> and run the following:</p><p><code class="cmd">"%PROGRAMFILES%\Microsoft SDKs\Windows\v6.0A\bin\xsltc.exe" /out:<var>SomeProjectPath</var>\bin\<var>SomeXsltDllFileName</var>.dll /class:<var>SomeXsltClassName</var> <var>PathAndFileNameOfXslt</var>.xsl</code></p><p><code>xsltc.exe</code> might be located somewhere else on your PC and be sure to update the appropriate info in the command above. If it works you can add a reference to this new DLL in your project and use the new class in your code:</p><pre class="cs">XslCompiledTransform xsl = new XslCompiledTransform();
xsl.Load(typeof(<var>SomeXsltClassName</var>));</pre><p>You can also add a pre-build event command line to your project:</p><p><code class="cmd">"%PROGRAMFILES%\Microsoft SDKs\Windows\v6.0A\bin\xsltc.exe" /out:$(ProjectDir)bin\<var>SomeXsltDllFileName</var>.dll /class:<var>SomeXsltClassName</var> $(ProjectDir)<var>RelativePathAndFileNameOfXsltInProject</var>.xsl</code></p><p>Then every time you hit <kbd>CTRL</kbd>+<kbd>SHIFT</kbd>+<kbd>B</kbd> it will build your XSLT's DLL automagically each time. Here's a sample of what your output should look like:</p><pre class="output" style="overflow:scroll">------ Build started: Project: ProjectName, Configuration: Debug Any CPU ------
Build started 7/22/2010 2:36:11 PM.

Target PreBuildEvent:
    "%PROGRAMFILES%\Microsoft SDKs\Windows\v6.0A\bin\xsltc.exe" /settings:script+ /out:D:\Projects\ProjectName\bin\SomeXsltDllFileName.dll /class:SomeXsltClassName D:\Projects\ProjectName\Xslt\NameOfXslt.xsl
    Microsoft (R) XSLT Compiler version 3.5.30729
    [Microsoft (R) .NET Framework version 2.0.50727]
    Copyright (C) Microsoft Corporation. All rights reserved.
    
Target CoreCompile:
    C:\WINDOWS\Microsoft.NET\Framework\v3.5\Csc.exe /noconfig /nowarn:1701,1702 /errorreport:prompt /warn:4 /define:DEBUG;TRACE /reference:bin\SomeXsltDllFileName.dll /reference:bin\SomeXsltDllFileName.script.dll /debug+ /debug:full /filealign:512 /optimize- /out:obj\Debug\ProjectName.dll /target:library ClassFiles.cs

Compile complete -- 0 errors, 0 warnings

Target _CopyFilesMarkedCopyLocal:
    Copying file from "bin\SomeXsltDllFileName.dll" to "bin\Debug\SomeXsltDllFileName.dll".
    Copying file from "bin\SomeXsltDllFileName.script.dll" to "bin\Debug\SomeXsltDllFileName.script.dll".
Target CopyFilesToOutputDirectory:
    Copying file from "obj\Debug\ProjectName.dll" to "bin\Debug\ProjectName.dll".
    ProjectName -> D:\Projects\ProjectName\bin\Debug\ProjectName.dll
    Copying file from "obj\Debug\ProjectName.pdb" to "bin\Debug\ProjectName.pdb".

Build succeeded.

Time Elapsed 00:00:02.31</pre><h4>More info:</h4><ul><li id="20100719-1"><a href="http://msdn.microsoft.com/en-us/library/bb399419.aspx">How to: Perform an XSLT Transformation by Using an Assembly</a></li><li id="20100719-2"><a href="http://msdn.microsoft.com/en-us/library/bb399405.aspx">XSLT Compiler (xsltc.exe)</a></li></ul></div></article></main><nav><h2>Other Stuff</h2><ul><li><a href="/posts/2011/05/13/adding-an-easy-shortcut-to-the-jshint-javascript-validator-to-visual-studio">Adding An Easy Shortcut to the JSHint javascript validator to Visual Studio</a></li><li><a href="/posts/2010/07/26/embedding-an-xslt-as-a-string-in-a-dll-binary" rel="prev">Embedding an XSLT as a string in a DLL binary</a></li><li><a href="/posts/2010/07/19/compiling-an-xslt-into-a-dll-binary" rel="self">Compiling an XSLT into a DLL binary</a></li><li><a href="/posts/2009/08/31/adding-an-easy-shortcut-to-the-jslint-javascript-validator-to-visual-studio" rel="next">Adding An Easy Shortcut to the JSLint javascript validator to Visual Studio</a></li><li><a href="/posts/2009/06/08/welcome-to-the-new-traviblog">Welcome to the new TraviBlog</a></li><li><a href="/posts" rel="archives ">Archive</a></li><li><a href="/about" rel="about ">About</a></li><li><a href="/tools">Tools</a></li><li><gcse:searchbox-only></gcse:searchbox-only></li></ul><h3>Folks</h3><ul><li><a href="http://ern.me/" rel="friend met co-worker colleague" title="Ern is my co-worker">Ern</a></li><li><a href="http://www.larryroth.net/" rel="friend met co-worker colleague" title="Larry is my boss">Larry</a></li><li><a href="http://ralphwhitbeck.com/" rel="friend met" title="Ralph is a former co-worker">Ralph</a></li><li><a href="http://sherrybdesign.com/" rel="friend met co-resident spouse sweetheart" title="Sherry is a Graphic Designer and my wife">Sherry</a></li></ul><h3>Work-related</h3><ul><li><a href="http://brandlogic.com/" title="Brandlogic is where I work">Brandlogic</a></li><li><a href="http://www.corebrand.com/" title="CoreBrand is a full service brand consultancy">CoreBrand</a></li><li><a href="http://www.tapdash.net/" title="TapDash, made by Brandlogic, is a real-time view of customer experience">TapDash</a></li></ul></nav><div id="comments"><a id="disqus_comments" href="/posts/2010/07/19/compiling-an-xslt-into-a-dll-binary#disqus_thread">Comments</a><div id="disqus_thread"></div><p><a href="//disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a></p></div><footer><h2>© Travis Hardiman, et al. 1979-2079.</h2><p>All puns intentional even if stated otherwise, all posts are owned by their respective owners, any code posted is public domain unless stated otherwise</p></footer><div id="weather"></div><script src="//code.jquery.com/jquery-2.1.0.min.js"></script><script src="/j/mainUNq.js"></script></body></html>