{"relativePath":"/posts/2010/07/19/compiling-an-xslt-into-a-dll-binary","comments":"","pubDate":"2010-07-19T18:51:30.414-04:00","title":"Compiling an XSLT into a DLL binary","subtitle":"","intro":"","categories":["programming","xml/xslt/xpath"],"body":"&lt;img src=&quot;http://farm5.static.flickr.com/4134/4819182574_af35276dbd_o.png&quot; alt=&quot;Project Properties - Pre-Build Event&quot; width=&quot;619&quot; height=&quot;383&quot; style=&quot;float:right;&quot; /&gt;&lt;p&gt;Did you know that Microsoft &lt;a href=&quot;#20100719-1&quot;&gt;provides&lt;/a&gt; &lt;a href=&quot;#20100719-2&quot;&gt;tools&lt;/a&gt; to compile XSLT files into DLLs? Neither did I before a client recently suggested that I do that on a recent project. It turns out it&#x27;s extremely easy.&lt;/p&gt;&lt;p&gt;Fire up your &lt;a href=&quot;http://sourceforge.net/projects/console/&quot;&gt;favorite console&lt;/a&gt; and run the following:&lt;/p&gt;&lt;p&gt;&lt;code class=&quot;cmd&quot;&gt;&quot;%PROGRAMFILES%\Microsoft SDKs\Windows\v6.0A\bin\xsltc.exe&quot; /out:&lt;var&gt;SomeProjectPath&lt;/var&gt;\bin\&lt;var&gt;SomeXsltDllFileName&lt;/var&gt;.dll /class:&lt;var&gt;SomeXsltClassName&lt;/var&gt; &lt;var&gt;PathAndFileNameOfXslt&lt;/var&gt;.xsl&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;xsltc.exe&lt;/code&gt; might be located somewhere else on your PC and be sure to update the appropriate info in the command above. If it works you can add a reference to this new DLL in your project and use the new class in your code:&lt;/p&gt;&lt;pre class=&quot;cs&quot;&gt;XslCompiledTransform xsl = new XslCompiledTransform();xsl.Load(typeof(&lt;var&gt;SomeXsltClassName&lt;/var&gt;));&lt;/pre&gt;&lt;p&gt;You can also add a pre-build event command line to your project:&lt;/p&gt;&lt;p&gt;&lt;code class=&quot;cmd&quot;&gt;&quot;%PROGRAMFILES%\Microsoft SDKs\Windows\v6.0A\bin\xsltc.exe&quot; /out:$(ProjectDir)bin\&lt;var&gt;SomeXsltDllFileName&lt;/var&gt;.dll /class:&lt;var&gt;SomeXsltClassName&lt;/var&gt; $(ProjectDir)&lt;var&gt;RelativePathAndFileNameOfXsltInProject&lt;/var&gt;.xsl&lt;/code&gt;&lt;/p&gt;&lt;p&gt;Then every time you hit &lt;kbd&gt;CTRL&lt;/kbd&gt;+&lt;kbd&gt;SHIFT&lt;/kbd&gt;+&lt;kbd&gt;B&lt;/kbd&gt; it will build your XSLT&#x27;s DLL automagically each time. Here&#x27;s a sample of what your output should look like:&lt;/p&gt;&lt;pre class=&quot;output&quot; style=&quot;overflow:scroll;&quot;&gt;------ Build started: Project: ProjectName, Configuration: Debug Any CPU ------Build started 7/22/2010 2:36:11 PM.Target PreBuildEvent:    &quot;%PROGRAMFILES%\Microsoft SDKs\Windows\v6.0A\bin\xsltc.exe&quot; /settings:script+ /out:D:\Projects\ProjectName\bin\SomeXsltDllFileName.dll /class:SomeXsltClassName D:\Projects\ProjectName\Xslt\NameOfXslt.xsl    Microsoft (R) XSLT Compiler version 3.5.30729    [Microsoft (R) .NET Framework version 2.0.50727]    Copyright (C) Microsoft Corporation. All rights reserved.    Target CoreCompile:    C:\WINDOWS\Microsoft.NET\Framework\v3.5\Csc.exe /noconfig /nowarn:1701,1702 /errorreport:prompt /warn:4 /define:DEBUG;TRACE /reference:bin\SomeXsltDllFileName.dll /reference:bin\SomeXsltDllFileName.script.dll /debug+ /debug:full /filealign:512 /optimize- /out:obj\Debug\ProjectName.dll /target:library ClassFiles.csCompile complete -- 0 errors, 0 warningsTarget _CopyFilesMarkedCopyLocal:    Copying file from &quot;bin\SomeXsltDllFileName.dll&quot; to &quot;bin\Debug\SomeXsltDllFileName.dll&quot;.    Copying file from &quot;bin\SomeXsltDllFileName.script.dll&quot; to &quot;bin\Debug\SomeXsltDllFileName.script.dll&quot;.Target CopyFilesToOutputDirectory:    Copying file from &quot;obj\Debug\ProjectName.dll&quot; to &quot;bin\Debug\ProjectName.dll&quot;.    ProjectName -&gt; D:\Projects\ProjectName\bin\Debug\ProjectName.dll    Copying file from &quot;obj\Debug\ProjectName.pdb&quot; to &quot;bin\Debug\ProjectName.pdb&quot;.Build succeeded.Time Elapsed 00:00:02.31&lt;/pre&gt;&lt;h4&gt;More info:&lt;/h4&gt;&lt;ul&gt;&lt;li id=&quot;20100719-1&quot;&gt;&lt;a href=&quot;http://msdn.microsoft.com/en-us/library/bb399419.aspx&quot;&gt;How to: Perform an XSLT Transformation by Using an Assembly&lt;/a&gt;&lt;/li&gt;&lt;li id=&quot;20100719-2&quot;&gt;&lt;a href=&quot;http://msdn.microsoft.com/en-us/library/bb399405.aspx&quot;&gt;XSLT Compiler (xsltc.exe)&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;","enclosures":[],"source":{"url":"","title":""},"changefreq":"never","priority":"0.1","bodyArticleHtml":"<hgroup><h3><time datetime=\"2010-07-19T22:51:30.414Z\" pubdate=\"pubdate\">2010-07-19</time></h3><h1><a href=\"http://dieseltravis.github.io/posts/2010/07/19/compiling-an-xslt-into-a-dll-binary\">Compiling an XSLT into a DLL binary</a></h1><h2></h2></hgroup><img src="http:<p>DidyouknowthatMicrosoft<ahref="#20100719-1">provides</a><ahref="#20100719-2">tools</a>tocompileXSLTfilesintoDLLs?NeitherdidIbeforeaclientrecentlysuggestedthatIdothatonarecentproject.Itturnsoutit'sextremelyeasy.</p><p>Fireupyour<ahref="http://sourceforge.net/projects/console/">favoriteconsole</a>andrunthefollowing:</p><p><codeclass="cmd">"%PROGRAMFILES%\Microsoft SDKs\Windows\v6.0A\bin\xsltc.exe"/out:<var>SomeProjectPath</var>\bin\<var>SomeXsltDllFileName</var>.dll/class:<var>SomeXsltClassName</var><var>PathAndFileNameOfXslt</var>.xsl</code></p><p><code>xsltc.exe</code>mightbelocatedsomewhereelseonyourPCandbesuretoupdatetheappropriateinfointhecommandabove.IfitworksyoucanaddareferencetothisnewDLLinyourprojectandusethenewclassinyourcode:</p><preclass="cs">XslCompiledTransformxsl=newXslCompiledTransform();xsl.Load(typeof(<var>SomeXsltClassName</var>));</pre><p>Youcanalsoaddapre-buildeventcommandlinetoyourproject:</p><p><codeclass="cmd">"%PROGRAMFILES%\Microsoft SDKs\Windows\v6.0A\bin\xsltc.exe"/out:$(ProjectDir)bin\<var>SomeXsltDllFileName</var>.dll/class:<var>SomeXsltClassName</var>$(ProjectDir)<var>RelativePathAndFileNameOfXsltInProject</var>.xsl</code></p><p>Theneverytimeyouhit<kbd>CTRL</kbd>+<kbd>SHIFT</kbd>+<kbd>B</kbd>itwillbuildyourXSLT'sDLLautomagicallyeachtime.Here'sasampleofwhatyouroutputshouldlooklike:</p><preclass="output"style="overflow:scroll;">------Buildstarted:Project:ProjectName,Configuration:DebugAnyCPU------Buildstarted7/22/20102:36:11PM.TargetPreBuildEvent:"%PROGRAMFILES%\Microsoft SDKs\Windows\v6.0A\bin\xsltc.exe"/settings:script+/out:D:\Projects\ProjectName\bin\SomeXsltDllFileName.dll/class:SomeXsltClassNameD:\Projects\ProjectName\Xslt\NameOfXslt.xslMicrosoft(R)XSLTCompilerversion3.5.30729[Microsoft(R).NETFrameworkversion2.0.50727]Copyright(C)MicrosoftCorporation.Allrightsreserved.TargetCoreCompile:C:\WINDOWS\Microsoft.NET\Framework\v3.5\Csc.exe/noconfig/nowarn:1701,1702/errorreport:prompt/warn:4/define:DEBUG;TRACE/reference:bin\SomeXsltDllFileName.dll/reference:bin\SomeXsltDllFileName.script.dll/debug+/debug:full/filealign:512/optimize-/out:obj\Debug\ProjectName.dll/target:libraryClassFiles.csCompilecomplete--0errors,0warningsTarget_CopyFilesMarkedCopyLocal:Copyingfilefrom"bin\SomeXsltDllFileName.dll"to"bin\Debug\SomeXsltDllFileName.dll".Copyingfilefrom"bin\SomeXsltDllFileName.script.dll"to"bin\Debug\SomeXsltDllFileName.script.dll".TargetCopyFilesToOutputDirectory:Copyingfilefrom"obj\Debug\ProjectName.dll"to"bin\Debug\ProjectName.dll".ProjectName->D:\Projects\ProjectName\bin\Debug\ProjectName.dllCopyingfilefrom"obj\Debug\ProjectName.pdb"to"bin\Debug\ProjectName.pdb".Buildsucceeded.TimeElapsed00:00:02.31</pre><h4>Moreinfo:</h4><ul><liid="20100719-1"><ahref="http://msdn.microsoft.com/en-us/library/bb399419.aspx">Howto:PerformanXSLTTransformationbyUsinganAssembly</a></li><liid="20100719-2"><ahref="http://msdn.microsoft.com/en-us/library/bb399405.aspx">XSLTCompiler(xsltc.exe)</a></li></ul>",	"bodyNavItems": [								{									"pageRel": "prev",								"href": "/posts/2011/05/13/adding-an-easy-shortcut-to-the-jshint-javascript-validator-to-visual-studio",				"text": "AddingAnEasyShortcuttotheJSHintjavascriptvalidatortoVisualStudio"			}					, 			{									"pageRel": "prev",								"href": "/posts/2010/07/26/embedding-an-xslt-as-a-string-in-a-dll-binary",				"text": "EmbeddinganXSLTasastringinaDLLbinary"			}					, 			{									"pageRel": "self",								"href": "/posts/2010/07/19/compiling-an-xslt-into-a-dll-binary",				"text": "CompilinganXSLTintoaDLLbinary"			}					, 			{									"pageRel": "next",								"href": "/posts/2009/08/31/adding-an-easy-shortcut-to-the-jslint-javascript-validator-to-visual-studio",				"text": "AddingAnEasyShortcuttotheJSLintjavascriptvalidatortoVisualStudio"			}					, 			{								"href": "/posts/2009/06/08/welcome-to-the-new-traviblog",				"text": "WelcometothenewTraviBlog"			}			]}