<!doctype html><html lang="en-us" class="no-js"><head><meta name="viewport" content="width=device-width"/><title>Embedding an XSLT as a string in a DLL binary</title><meta name="description" content="[object Object]"/><meta name="author" content="Travis Hardiman"/><meta name="copyright" content="© Travis Hardiman, et al. 1979-2079."/><link rel="stylesheet" href="/s/mainb13.css"/><link rel="canonical" href="http://dieseltravis.github.io/posts/2010/07/26/embedding-an-xslt-as-a-string-in-a-dll-binary"/><link rel="alternate" type="application/rss+xml" title="RSS" href="http://dieseltravis.github.io/rss.rss"/><link rel="alternate" type="application/atom+xml" title="Atom" href="http://dieseltravis.github.io/atom.atom"/></head><body><header><hgroup><h1><a href="/" rel="home">traviblog</a></h1><h2>just some sort of lame blog</h2></hgroup></header><main><article class="h-entry"><hgroup><h3><time datetime="2010-07-26T18:00:05.852Z" pubdate="pubdate" class="dt-published">2010-07-26</time></h3><h1><a href="/posts/2010/07/26/embedding-an-xslt-as-a-string-in-a-dll-binary" class="u-url p-name">Embedding an XSLT as a string in a DLL binary</a></h1><h2 class="p-summary"></h2></hgroup><div class="e-content"><a href="http://www.flickr.com/photos/diesel_travis/4819182556/sizes/o/in/photostream/" style="display:block;float:right"><img src="http://farm5.static.flickr.com/4082/4819182556_7eefd75c20_d.jpg" width="500" height="233" alt="Project Properties - Resources" style="display:block"/></a><p>If you want to distribute a class library that relies on an XSL document and only want to worry about a single DLL then this is probably the easiest solution. In Visual Studio follow these commands (and save): Project Properties → Resources → Add Existing file</p><p>In this case, I am embedding a file named <var>Core.xsl</var> with a key named <var>Core</var>. That will generate a bit of code that looks like this:</p><h4>~/Properties/Resources.resx:</h4><pre class="xml" style="clear:both">&lt;data name="Core" type="System.Resources.ResXFileRef, System.Windows.Forms"&gt;
	&lt;value&gt;..\Resources\Core.xsl;System.String, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089;utf-8&lt;/value&gt;
&lt;/data&gt;</pre><h4>~/Properties/Resources.Designer.cs:</h4><pre class="cs" style="clear:both">public static string Core {
	get {
		return ResourceManager.GetString("Core", resourceCulture);
	}
}</pre><img src="http://farm5.static.flickr.com/4078/4818559695_a00bb0862a_d.jpg" width="474" height="264" alt="XSL file properties" style="clear: left; float: right"/><p>Be sure to set the properties of the file so that its <var>Build Action</var> is set as an <code>Embedded Resource</code>.</p><p>Now when you compile, the entire contents of the XSL file get embedded directly into the DLL as a string. You can now use the new property like this:</p><pre class="cs" style="clear:both">public static XslCompiledTransform GetXsl(XmlDocument xDoc)
{
	bool enableDocumentFunction = false;
	bool enableScript = true;
	XsltSettings xslSettings = new XsltSettings(enableDocumentFunction, enableScript);

	// only enable debugging in DEBUG mode
	bool isDebug = true;
#if (!DEBUG)
	isDebug = false;
#endif

	XslCompiledTransform xsl = new XslCompiledTransform(isDebug);
	xsl.Load(xDoc, xslSettings, new XmlUrlResolver());

	return xsl;
}

public static XslCompiledTransform GetXsl()
{
	XmlDocument xDoc = new XmlDocument();
	xDoc.LoadXml(Properties.Resources.Core);
	XslCompiledTransform xsl = GetXsl(null, xDoc);
	return xsl;
}</pre><h4>Previous XSLT stuff:</h4><p><a href="http://travis.servebeer.com/blog.net/2010/07/19/Compiling+An+XSLT+Into+A+DLL+Binary.aspx">Compiling An XSLT Into A DLL Binary</a></p></div></article></main><nav><h2>Other Stuff</h2><ul><li><a href="/posts/2014/04/05/frost-pisst">Frost Pisst</a></li><li><a href="/posts/2011/05/13/adding-an-easy-shortcut-to-the-jshint-javascript-validator-to-visual-studio" rel="prev">Adding An Easy Shortcut to the JSHint javascript validator to Visual Studio</a></li><li><a href="/posts/2010/07/26/embedding-an-xslt-as-a-string-in-a-dll-binary" rel="self">Embedding an XSLT as a string in a DLL binary</a></li><li><a href="/posts/2010/07/19/compiling-an-xslt-into-a-dll-binary" rel="next">Compiling an XSLT into a DLL binary</a></li><li><a href="/posts/2009/08/31/adding-an-easy-shortcut-to-the-jslint-javascript-validator-to-visual-studio">Adding An Easy Shortcut to the JSLint javascript validator to Visual Studio</a></li><li><a href="/posts" rel="archives ">Archive</a></li><li><a href="/about" rel="about ">About</a></li><li><a href="/tools">Tools</a></li><li><gcse:searchbox-only></gcse:searchbox-only></li></ul><h3>Folks</h3><ul><li><a href="http://ern.me/" rel="friend met co-worker colleague" title="Ern is my co-worker">Ern</a></li><li><a href="http://www.larryroth.net/" rel="friend met co-worker colleague" title="Larry is my boss">Larry</a></li><li><a href="http://ralphwhitbeck.com/" rel="friend met" title="Ralph is a former co-worker">Ralph</a></li><li><a href="http://sherrybdesign.com/" rel="friend met co-resident spouse sweetheart" title="Sherry is a Graphic Designer and my wife">Sherry</a></li></ul><h3>Work-related</h3><ul><li><a href="http://brandlogic.com/" title="Brandlogic is where I work">Brandlogic</a></li><li><a href="http://www.corebrand.com/" title="CoreBrand is a full service brand consultancy">CoreBrand</a></li><li><a href="http://www.tapdash.net/" title="TapDash, made by Brandlogic, is a real-time view of customer experience">TapDash</a></li></ul></nav><div id="comments"><a id="disqus_comments" href="/posts/2010/07/26/embedding-an-xslt-as-a-string-in-a-dll-binary#disqus_thread">Comments</a><div id="disqus_thread"></div><p><a href="//disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a></p></div><footer><h2>© Travis Hardiman, et al. 1979-2079.</h2><p>All puns intentional even if stated otherwise, all posts are owned by their respective owners, any code posted is public domain unless stated otherwise</p></footer><div id="weather"></div><script src="//code.jquery.com/jquery-2.1.0.min.js"></script><script src="/j/maina0z.js"></script></body></html>